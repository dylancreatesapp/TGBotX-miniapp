<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Telegram Login</title>
</head>
<body>
  <!-- Telegram Login Widget -->
  <script async src="https://telegram.org/js/telegram-widget.js?15"
          data-telegram-login="@TGBotXutility_bot"  <!-- Replace with your bot's username -->
          data-size="large"
          data-userpic="false"
          data-request-access="write"
          data-onauth="onTelegramAuth(user)">
  </script>

  <script type="text/javascript">
    // This function is called once the user successfully logs in
    function onTelegramAuth(user) {
      console.log("User data received:", user);
      // Send the Telegram user data to your server for verification and sign-up
      fetch('/auth/telegram', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(user)
      })
      .then(response => response.json())
      .then(data => {
          // Process the response (e.g., store session, redirect within the mini app)
          console.log("Server response:", data);
          // Optionally, redirect the user to the main part of your mini app
      })
      .catch(error => {
          console.error("Authentication error:", error);
      });
    }
  </script>
</body>
</html>
