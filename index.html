<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>TGBotX Mini-App</title>
    <!-- Using Bootstrap for a clean, responsive design -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
    />
  </head>
  <body class="bg-light text-dark">
    <div class="container my-5">
      <!-- Title and user info -->
      <h1 class="mb-4">Welcome to TGBotX Mini-App</h1>
      <p id="user-info">Loading user info...</p>

      <!-- Existing button: Check My Token Balance -->
      <button id="check-token" class="btn btn-primary">
        Check My Token Balance
      </button>

      <!-- New wallet address input section -->
      <div class="mb-3 mt-4">
        <label for="walletAddress" class="form-label">Enter Your Wallet Address:</label>
        <input
          type="text"
          class="form-control"
          id="walletAddress"
          placeholder="e.g., 0x1234...abcd"
        />
      </div>

      <button id="check-wallet" class="btn btn-secondary">
        Check Balance
      </button>

      <!-- Area for error messages -->
      <div id="error-message" class="mt-2 text-danger"></div>

      <!-- Result display -->
      <div id="result" class="mt-3"></div>
    </div>

    <script>
      (function() {
        // 1) Check if we're inside Telegram
        let tg;
        if (typeof window.Telegram !== 'undefined' && window.Telegram.WebApp) {
          tg = window.Telegram.WebApp;
          tg.expand(); // Expand the mini-app to full height inside Telegram

          // Display the Telegram user's first name (if available)
          const initDataUnsafe = tg.initDataUnsafe || {};
          document.getElementById("user-info").innerText =
            "Hello " + (initDataUnsafe.user?.first_name || "mysterious user") + "!";
        } else {
          // Fallback for normal browsers
          document.getElementById("user-info").innerText =
            "Hello from outside Telegram!";
        }

        // 2) "Check My Token Balance" button (simple example)
        document.getElementById("check-token").addEventListener("click", () => {
          let tokenBalance = 100; // simulate a token balance
          document.getElementById("result").innerText =
            `You currently hold ${tokenBalance} tokens.`;
        });

        // 3) "Check Balance" button for the wallet address input
        document.getElementById("check-wallet").addEventListener("click", () => {
          const walletAddress = document
            .getElementById("walletAddress")
            .value.trim();
          const errorMessage = document.getElementById("error-message");
          const result = document.getElementById("result");

          // Clear any previous error
          errorMessage.innerText = "";

          // Validate the input
          if (!walletAddress) {
            errorMessage.innerText = "Please enter a valid wallet address.";
            return;
          }

          // For now, we simulate a balance check
          result.innerText = `Wallet ${walletAddress} has 500 tokens (simulated).`;
        });
      })();
    </script>
  </body>
</html>
